# Cloud927 v4.0 Configuration
# Personal Decision Reference System

# Application Settings
app:
  name: "Cloud927"
  version: "4.0.0"
  log_level: "INFO"

# LLM Configuration (dual-layer architecture)
llm:
  preprocessor:
    provider: gemini
    model: gemini-2.0-flash
    api_key_env: GEMINI_API_KEY
  insight:
    provider: claude
    model: claude-opus-4-5
    api_key_env: ANTHROPIC_AUTH_TOKEN
    base_url: "https://code.newcli.com/claude/droid"

# Pipeline Configuration
pipeline:
  max_workers: 12
  stages:
    fetch: true
    deduplicate: true
    cluster: true
    timeline: true
    preprocess: true
    generate: true
    save: true

# Six Sector Groups
fetcher_groups:
  ai_frontier:
    sources: [hn, github, hf, ai_news, reddit, ph, v2ex, hn_show, twitter, arxiv]
    fetch_parallel: true
    max_workers: 10

  startup:
    sources: [techcrunch, 36kr_startup, itjuzi]
    fetch_parallel: true
    max_workers: 3

  finance:
    sources: [ft, bloomberg, yahoo_finance]
    fetch_parallel: true
    max_workers: 3

  crypto:
    sources: [coindesk, theblock, decrypt]
    fetch_parallel: true
    max_workers: 3

  policy:
    sources: [techpolicy, china_policy]
    fetch_parallel: true
    max_workers: 2

  global_events:
    sources: [reuters, ap_news, bbc_world, pengpai, caixin, jinri_remai, sina, ifeng]
    fetch_parallel: true
    max_workers: 8

# Individual Data Source Configurations
sources:
  # === AI 前沿 ===
  hn:
    enabled: true
    type: "api"
    priority: "P0"
    category: "ai_tech"
    fetch_interval_minutes: 60
    timeout_seconds: 30
    retry_attempts: 3
    filters:
      freshness_hours: 24
      min_score: 50

  github:
    enabled: true
    type: "api"
    priority: "P0"
    category: "ai_tech"
    fetch_interval_minutes: 240
    timeout_seconds: 30
    retry_attempts: 3
    filters:
      languages: ["python", "typescript"]
      min_stars: 100

  hf:
    enabled: true
    type: "api"
    priority: "P1"
    category: "ai_tech"
    fetch_interval_minutes: 480
    timeout_seconds: 30
    retry_attempts: 3
    filters:
      papers_limit: 20

  ai_news:
    enabled: true
    type: "rss"
    priority: "P0"
    category: "ai_tech"
    fetch_interval_minutes: 120
    timeout_seconds: 30
    retry_attempts: 3
    sources:
      - "https://openai.com/news/rss.xml"
      - "https://www.anthropic.com/rss.xml"
      - "https://blog.google/rss.xml"
      - "https://about.fb.com/news/rss/"

  reddit:
    enabled: true
    type: "api"
    priority: "P1"
    category: "ai_tech"
    fetch_interval_minutes: 180
    timeout_seconds: 30
    retry_attempts: 3
    subreddits: ["MachineLearning", "artificial", "LocalLLaMA", "OpenAI"]
    filters:
      min_score: 10
      max_age_hours: 24

  ph:
    enabled: true
    type: "rss"
    priority: "P1"
    category: "ai_tech"
    fetch_interval_minutes: 360
    timeout_seconds: 30
    retry_attempts: 3
    filters:
      days_back: 7

  v2ex:
    enabled: true
    type: "rss"
    priority: "P1"
    category: "ai_tech"
    fetch_interval_minutes: 180
    timeout_seconds: 30
    retry_attempts: 3
    nodes: ["share", "ai"]

  hn_show:
    enabled: true
    type: "api"
    priority: "P2"
    category: "ai_tech"
    fetch_interval_minutes: 240
    timeout_seconds: 30
    retry_attempts: 3

  # New Global News Sources
  reuters:
    enabled: true
    type: "rss"
    priority: "P0"
    category: "global_news"
    fetch_interval_minutes: 60
    timeout_seconds: 30
    retry_attempts: 3
    rss_url: "https://www.reutersagency.com/feed/?best-topics=world-news&LOC=19254"
    filters:
      freshness_hours: 24
      categories: ["World News", "Politics", "Business"]

  ap_news:
    enabled: true
    type: "rss"
    priority: "P0"
    category: "global_news"
    fetch_interval_minutes: 60
    timeout_seconds: 30
    retry_attempts: 3
    rss_url: "https://feeds.ap.org/feed/rss/AllStories"
    filters:
      freshness_hours: 24

  bbc_world:
    enabled: true
    type: "rss"
    priority: "P1"
    category: "global_news"
    fetch_interval_minutes: 120
    timeout_seconds: 30
    retry_attempts: 3
    rss_url: "http://feeds.bbci.co.uk/news/world/rss.xml"
    filters:
      freshness_hours: 24

  # New China Tech Sources
  jinri_remai:
    enabled: true
    type: "rss"
    priority: "P0"
    category: "china_tech"
    fetch_interval_minutes: 120
    timeout_seconds: 30
    retry_attempts: 3
    rss_url: "https://rsshub.app/toutiao/rss/人工智能"
    filters:
      freshness_hours: 48

  sina:
    enabled: true
    type: "rss"
    priority: "P1"
    category: "china_tech"
    fetch_interval_minutes: 180
    timeout_seconds: 30
    retry_attempts: 3
    rss_url: "https://rsshub.app/sina/focus"
    filters:
      freshness_hours: 24

  ifeng:
    enabled: true
    type: "rss"
    priority: "P1"
    category: "china_tech"
    fetch_interval_minutes: 180
    timeout_seconds: 30
    retry_attempts: 3
    rss_url: "https://rsshub.app/ifeng/news"
    filters:
      freshness_hours: 24

  36kr:
    enabled: true
    type: "rss"
    priority: "P0"
    category: "china_tech"
    fetch_interval_minutes: 180
    timeout_seconds: 30
    retry_attempts: 3
    rss_url: "https://rsshub.app/36kr/news"
    filters:
      freshness_hours: 48

  机器之心:
    enabled: true
    type: "rss"
    priority: "P0"
    category: "china_tech"
    fetch_interval_minutes: 240
    timeout_seconds: 30
    retry_attempts: 3
    rss_url: "https://rsshub.app/jiqizhixin"
    filters:
      freshness_hours: 72

  # New China Society Sources
  pengpai:
    enabled: true
    type: "rss"
    priority: "P0"
    category: "china_society"
    fetch_interval_minutes: 120
    timeout_seconds: 30
    retry_attempts: 3
    rss_url: "https://rsshub.app/thepaper"
    filters:
      freshness_hours: 24

  xinjingbao:
    enabled: true
    type: "rss"
    priority: "P0"
    category: "china_society"
    fetch_interval_minutes: 120
    timeout_seconds: 30
    retry_attempts: 3
    rss_url: "https://rsshub.app/bjnews"
    filters:
      freshness_hours: 24

  caixin:
    enabled: true
    type: "rss"
    priority: "P1"
    category: "china_society"
    fetch_interval_minutes: 180
    timeout_seconds: 30
    retry_attempts: 3
    rss_url: "https://rsshub.app/caixin"
    filters:
      freshness_hours: 48

  rmrb:
    enabled: true
    type: "rss"
    priority: "P1"
    category: "china_society"
    fetch_interval_minutes: 240
    timeout_seconds: 30
    retry_attempts: 3
    rss_url: "https://rsshub.app/people"
    filters:
      freshness_hours: 48

  # Supplementary AI Sources
  twitter:
    enabled: true
    type: "rss"
    priority: "P1"
    category: "ai_tech"
    fetch_interval_minutes: 60
    timeout_seconds: 30
    retry_attempts: 3
    rss_url: "https://nitter.net/elonmusk/rss"
    filters:
      freshness_hours: 12

  arxiv:
    enabled: true
    type: "api"
    priority: "P1"
    category: "ai_tech"
    fetch_interval_minutes: 720
    timeout_seconds: 60
    retry_attempts: 3
    filters:
      categories: ["cs.AI", "cs.LG", "cs.CL"]
      max_results: 50

  # === 创业/投融资 ===
  techcrunch:
    enabled: true
    type: "rss"
    priority: "P0"
    category: "startup"
    fetch_interval_minutes: 120
    timeout_seconds: 30
    retry_attempts: 3

  36kr_startup:
    enabled: true
    type: "rss"
    priority: "P0"
    category: "startup"
    fetch_interval_minutes: 180
    timeout_seconds: 30
    retry_attempts: 3

  itjuzi:
    enabled: true
    type: "rss"
    priority: "P1"
    category: "startup"
    fetch_interval_minutes: 360
    timeout_seconds: 30
    retry_attempts: 3

  # === 金融/宏观 ===
  ft:
    enabled: true
    type: "rss"
    priority: "P0"
    category: "finance"
    fetch_interval_minutes: 120
    timeout_seconds: 30
    retry_attempts: 3

  bloomberg:
    enabled: true
    type: "rss"
    priority: "P0"
    category: "finance"
    fetch_interval_minutes: 120
    timeout_seconds: 30
    retry_attempts: 3

  yahoo_finance:
    enabled: true
    type: "rss"
    priority: "P1"
    category: "finance"
    fetch_interval_minutes: 240
    timeout_seconds: 30
    retry_attempts: 3

  # === Web3/Crypto ===
  coindesk:
    enabled: true
    type: "rss"
    priority: "P0"
    category: "crypto"
    fetch_interval_minutes: 120
    timeout_seconds: 30
    retry_attempts: 3

  theblock:
    enabled: true
    type: "rss"
    priority: "P0"
    category: "crypto"
    fetch_interval_minutes: 120
    timeout_seconds: 30
    retry_attempts: 3

  decrypt:
    enabled: true
    type: "rss"
    priority: "P1"
    category: "crypto"
    fetch_interval_minutes: 180
    timeout_seconds: 30
    retry_attempts: 3

  # === 科技政策 ===
  techpolicy:
    enabled: true
    type: "rss"
    priority: "P1"
    category: "policy"
    fetch_interval_minutes: 240
    timeout_seconds: 30
    retry_attempts: 3

  china_policy:
    enabled: true
    type: "rss"
    priority: "P1"
    category: "policy"
    fetch_interval_minutes: 360
    timeout_seconds: 30
    retry_attempts: 3

# Processing Configuration
processing:
  deduplication:
    enabled: true
    exact_match_threshold: 0.95
    fuzzy_match_threshold: 0.80
    priority_rules:
      - "official_sources"
      - "update_time"
      - "title_match"

  clustering:
    enabled: true
    method: "keyword"  # or "embedding"
    max_cluster_size: 5
    categories:
      - "AI前沿"
      - "创业/投融资"
      - "金融/宏观"
      - "Web3/Crypto"
      - "科技政策"
      - "全球重大事件"

  timeline:
    enabled: true
    state_file: "data/timeline_state.json"
    entities:
      - "OpenAI"
      - "Google"
      - "Anthropic"
      - "Meta"
      - "字节跳动"
      - "阿里巴巴"
      - "百度"

  temporal_filter:
    enabled: true
    rules:
      news:
        business_hours_window_hours: 2
        off_hours_window_hours: 6
        weekend_window_hours: 8
      github:
        window_hours: 24
      paper:
        window_hours: 168  # 7 days
      social:
        window_hours: 48

# Output Configuration
output:
  format: "markdown"
  max_articles_per_category: 10
  include_timeline: true
  include_clusters: true
  obsidian:
    enabled: true
    vault_path: ""
    folder: "Daily Report"

# Source Priority Ranking (higher = more trusted)
source_priority:
  official:
    - "openai.com"
    - "anthropic.com"
    - "google.com"
    - "meta.com"
    - "arxiv.org"
  news:
    - "reuters.com"
    - "apnews.com"
    - "bbc.com"
    - "thepaper.cn"
    - "caixin.com"
  tech:
    - "github.com"
    - "huggingface.co"
    - "36kr.com"
    - "jiqizhixin.com"
  social:
    - "reddit.com"
    - "v2ex.com"
    - "twitter.com"
    - "hn"
